<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      .container{
        height: 20rem;
        width: 20rem;
        background-color: antiquewhite;
      }
      #a, #b { border: solid 1px brown; }
      .active {
        background: aquamarine;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h3>ðŸ˜€</h3>
      <input type="text" />
      <div class="boxs"></div>
    </div>
    <script>
      // è§‚å¯Ÿè€…æ¨¡å¼:
      // åœ¨æ­¤éœ€æ±‚ä¸­, éœ€è¦è®¢é˜…inputæ¡†çš„è¾“å…¥, å†å†³å®šä¸‹é¢çš„åŒºå—æ˜¯å¦éœ€è¦é«˜äº®å­—å—:
      class input {
        constructor(el){
          this.observers = []
          el.addEventListener('input', e => {
            // é€šçŸ¥è§‚å¯Ÿè€…, å³inputæ¡†
            this.notifyAll(e.target.value)
          })
        }
        notifyAll(value){
          this.observers.forEach(item =>item.notify(value))
        }
        addObserver(ob) {
          this.observers.push(ob)
        }
      }

      class Observer extends DocumentFragment {
        constructor(txt){
          super()
          this.div = document.createElement('div')
          this.div.className = 'box'
          this.div.innerHTML = txt
          document.querySelector('.boxs').append(this.div)
        }
        notify(value){
          this.div.classList.toggle('active', this.handle(value))
        }
      }

      class defaultObserver extends Observer {
        constructor(txt){
          // super ç›´æŽ¥è°ƒç”¨å…¶çˆ¶ç±» Observerçš„constructor()hå‡½æ•°çš„æ‰€æœ‰å±žæ€§:
          super(txt)
          this.txt = txt
        }
        handle(value){
          return value.indexOf(this.txt) !== -1
        }
      }

      class numberOberserver extends Observer{
        constructor(txt){
          super(txt)
        }
        handle(value){ return /\d/.test(value) }
      }

      // 1. ç”¨è§‚å¯Ÿè€…è®¢é˜…inputè¾“å…¥æ¡†:
      const ipt = new input(document.querySelector('input'))
      // 2. åˆ©ç”¨inputç±»ä¸­çš„addObserverå‡½æ•°åˆ›å»ºæ–°çš„div:
      ipt.addObserver(new defaultObserver('a'))
      ipt.addObserver(new defaultObserver('b'))
      ipt.addObserver(new defaultObserver('c'))
      ipt.addObserver(new numberOberserver('æ•°å­—'))
    </script>
  </body>
</html>
